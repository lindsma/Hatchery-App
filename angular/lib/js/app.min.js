!function(a){"use strict";function b(b,c,d){var e=a("#"+b).html(),b=Handlebars.compile(e),d=d||{},f=b(d);a(f).prependTo(c).fadeIn()}function c(){this.playersChosen=!1,this.players={player1:{selected:!1},player2:{selected:!1}},this.init()}function d(a){this.info={name:a,health:100,attacks:{primary:{min:9,max:15},secondary:{min:5,max:20},special:{min:3,max:30}}},this.defineInfo()}c.prototype={turns:{p1:!0,p2:!1},stages:{select:{display:function(e){var f=c.prototype.stages.select;b("selection-screen",".container"),a(".container").on("click",".character",function(){var c=a(this).attr("data-id");e.players.player1.selected?e.players.player2.selected||(e.players.player2=new d(c),e.players.player2.selected=!0,e.players.player2.player="two",e.playersChosen=!0,e.storage.set(e),b("character",".player-two.selection",{name:e.players.player2.info.name}),a(".fight, .characters-selection, h1").fadeToggle(),f.bindFightBtn(e)):(e.players.player1=new d(c),e.players.player1.selected=!0,e.players.player1.player="one",b("character",".player-one.selection",{name:e.players.player1.info.name}))})},bindFightBtn:function(b){a(".container").on("click",".fight",function(){b.stages.fight.display(b)})}},fight:{fightTime:null,display:function(d){a(".container").empty();var e=c.prototype.stages.fight;b("fight-screen",".container",d),e.setTimer(),e.bindAttackButtons(d)},setTimer:function(){var b=c.prototype.stages.fight;b.fightTime=setInterval(function(){var c=a(".timer").find("p").text(),d=Number(c)-1;d>=0?(d<10&&(d="0"+d),a(".timer").find("p").text(d)):(clearInterval(b.fightTime),console.log("done"))},1e3)},clearInterval:function(){var a=c.prototype.stages.fight;clearInterval(a.fightTime)},bindAttackButtons:function(b){var e=c.prototype.stages.fight,f=c.prototype.turns;a(".container").on("click",".primary, .secondary, .special",function(){var c,g=a(this).attr("class");f.p1?(f.p1=!1,f.p2=!0,c=b.players.player1):(f.p1=!0,f.p2=!1,c=b.players.player2),e.toggleAttackButtons(),d.prototype.attack(c,g,b)})},toggleAttackButtons:function(){a(".buttons-container").toggle()}}},storage:{set:function(a){localStorage.setItem("game",JSON.stringify(a))},get:function(){return!!localStorage.game&&JSON.parse(localStorage.game)},clear:function(){localStorage.removeItem("game")}},init:function(){var a=c.prototype.storage.get()||this;a.playersChosen?this.stages.fight.display(a):this.stages.select.display(a)}},d.prototype={defineInfo:function(){switch(this.info.name){case"scorpion":break;case"subzero":break;case"raiden":break;case"liukang":break;case"shaokahn":this.info.health=110}},attack:function(a,b,d){var e=a.info.attacks[b],f=Math.floor(Math.random()*(e.max-e.min+1)+e.min),g=a.player;"one"===g?d.players.player2.info.health-f>0?d.players.player2.info.health-=f:(d.players.player2.info.health=0,alert(d.players.player1.info.name+" Wins!"),c.prototype.storage.clear(),clearInterval(c.prototype.stages.fight.clearInterval())):d.players.player1.info.health-f>0?d.players.player1.info.health-=f:(d.players.player1.info.health=0,alert(d.players.player2.info.name+" Wins!"),c.prototype.storage.clear(),clearInterval(c.prototype.stages.fight.clearInterval()))}};new c}(jQuery);